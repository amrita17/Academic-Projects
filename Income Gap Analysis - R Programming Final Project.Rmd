---
title: "Final Project"
author: "Amrita Sharma"
date: "December 4, 2017"
output: 
  html_document:
    toc: true
    toc_depth: 4
    theme: paper
    highlight: tango
  
---

Collaborators:
Meghana Jani


# Project outline
This project tries to identify if there is a significant difference in income between men and women across different factors. Six factors - Race, Region, Marital Status, Family Size, Urban Rural and Spouse Income are identified as potential factors for impacting the income difference between men and women. The data is cleansed and processed for analysis. Then in Data Summary part, distribution of data is studied and our hypothesis  about the factors is tested. Then Regression analysis is performed by considering different combination of factors and the findings are analyzed.  Finally, the major conclusions are drawn from the analysis.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
``` 

```{r, echo = FALSE, message = FALSE, warning=FALSE}
library(MASS)
library(plyr)
library(dplyr)
library(ggplot2)
library(knitr)
library(GGally)
```

#### Data in a glance

```{r, echo = FALSE}
# Import starting data
nlsy.all <- read.csv("http://www.andrew.cmu.edu/user/achoulde/94842/final_project/nlsy79/nlsy79_income.csv", header=TRUE)

#### Variables present in the base data set

# Change column names to question name abbreviations 
colnames(nlsy.all) <- c("VERSION_R25_2012",
    "CASEID_1979",
    "FAM-2A_1979",
    "FAM-POB_1979",
    "FAM-3_1979",
    "FAM-3A_1979",
    "FAM-RES_1979",
    "FAM-6_1979",
    "R_REL-1_COL_1979",
    "SCHOOL-31_1979",
    "MIL-6_1979",
    "WOMENS-ROLES_000001_1979",
    "WOMENS-ROLES_000002_1979",
    "WOMENS-ROLES_000003_1979",
    "WOMENS-ROLES_000004_1979",
    "WOMENS-ROLES_000006_1979",
    "WOMENS-ROLES_000007_1979",
    "WOMENS-ROLES_000008_1979",
    "EXP-OCC_1979",
    "EXP-9_1979",
    "race",
    "gender",
    "MARSTAT-KEY_1979",
    "FAMSIZE_1979",
    "POVSTATUS_1979",
    "POLICE-1_1980",
    "POLIC-1C_1980",
    "POLICE-2_1980",
    "ALCH-2_1983",
    "DS-8_1984",
    "DS-9_1984",
    "Q13-5_TRUNC_REVISED_1990",
    "POVSTATUS_1990",
    "HGCREV90_1990",
    "JOBSNUM_1990",
    "NUMCH90_1990",
    "AGEYCH90_1990",
    "DS-12_1998",
    "DS-13_1998",
    "INDALL-EMP.01_2000",
    "CPSOCC80.01_2000",
    "OCCSP-55I_CODE_2000",
    "Q2-15B_2000",
    "Q10-2_2000",
    "Q13-5_TRUNC_REVISED_2000",
    "FAMSIZE_2000",
    "TNFI_TRUNC_2000",
    "POVSTATUS_2000",
    "MARSTAT-COL_2000",
    "marital.status",
    "MO1M1B_XRND",
    "Q2-10B~Y_2012",
    "industry",
    "OCCALL-EMP.01_2012",
    "OCCSP-55I_CODE_2012",
    "Q2-15A_2012",
    "Q12-6_2012",
    "income",
    "Q13-5_SR000001_2012",
    "Q13-5_SR000002_2012",
    "spouse.income",
    "Q13-18_SR000001_TRUNC_2012",
    "famsize",
    "region",
    "education",
    "urban.rural",
    "JOBSNUM_2012")

### Subset the data to work on only our columns of interest
nlsy <- nlsy.all[c("race","gender","income","famsize","region","marital.status", "urban.rural", "spouse.income")]

# For spouse income variable we've 3479 valid skips(-4). So changing that to zero
nlsy$spouse.income <- mapvalues(nlsy$spouse.income, -4, 0)

# Change the values for valid skips, invalid skips, refusal, don't know and non-interview to NA
nlsy[nlsy < 0]  <- NA

# Remove NA rows from data which have NA in income since NA income will not be helpful 
nlsy <- nlsy[!is.na(nlsy[,3]),]

# removing the topcoded income from data
nlsy <- filter(nlsy, income < max(income))


# Converting numeric variables into corresponding factor levels

nlsy <- mutate(nlsy, gender = as.factor(mapvalues(nlsy$gender, 
                                             from = c(1, 2), 
                                             to = c("MALE", "FEMALE"))),
                    race = as.factor(mapvalues(nlsy$race, 
                                             from = c(1, 2, 3), 
                                             to = c("HISPANIC", "BLACK", "OTHER"))),
                    region = as.factor(mapvalues(nlsy$region, 
                                                 from = c(1, 2, 3, 4), 
                                                 to = c("NORTHEAST", "NORTH_CENTRAL", "SOUTH", "WEST"))),
                   marital.status = as.factor(mapvalues(nlsy$marital.status, 
                                                 from = c(0, 1, 2, 3, 6), 
                                                 to = c("NEVER MARRIED", "MARRIED", "SEPARATED", "DIVORCED", "WIDOWED"))),
                   urban.rural = as.factor(mapvalues(nlsy$urban.rural, 
                                                 from = c(0, 1, 2), 
                                                 to = c("RURAL", "URBAN", "UNKNOWN"))))
# Display summary of data
str(nlsy)
summary(nlsy)
options(scipen = 100)
```

The above table shows that we've total 6881 observations of 8 variables. Also the name of the variables and their type is displayed. For instance race is a factor variable with 3 levels (3 possible value - BLACK, HISPANIC and OTHER). And income is a continuous variable of the type int. The second table shows the more detailed summary of the data. For continuous variable like income or spouse income, its mean, median etc are shown and for factor variables like race its levels and the count of rows in each factor are displayed. 


## Part 1 : Data Summary

We need to identify if there is a statistically significant difference in income between men and women. So, we can try to see the distribution of our variables of interest by plotting different charts.

**Distributions of Income and Gender in data :**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
qplot( x = income, data = nlsy, geom = "histogram", xlab = "Income(in $)", ylab = "Count") +
  ggtitle("Histogram for Income") # plot for income 
qplot( x = gender, data = nlsy, fill = gender, geom = "bar", xlab = "Gender", ylab = "Count") +
  ggtitle("Histogram for Gender") # plot for gender distribution in the data 
```

**Income Distribution - **

We've total of `r nrow(nlsy)` rows of data being observed in our analysis. Of this total of `r with(nlsy, nrow(nlsy[income == 0,]))` respondents have zero income. The histogram's tail has a positive skew to the right (Mean income is higher than median income). The mean income in the distribution is `r round(mean(nlsy$income))` USD and the median income is `r round(median(nlsy$income))` USD. 

The income skewness to the right is also due to lower bound on  the data that income cannot be less than zero dollars whereas high income can go up to any range. In general, this right skewness of income limits the analysis since we cannot confidently estimate the expected value of the income for this distribution.  

**Gender distribution - **

Of the total `r nrow(nlsy)` respondents, `r with(nlsy, nrow(nlsy[gender  == "FEMALE",]))` are female and `r with(nlsy, nrow(nlsy[gender  == "MALE",]))` are male. Clearly number of female is higher than number of male in data.

### 1(a)  Race 
**Hypothesis -  There is a statistically significant difference between income of men and women for people belonging to hispanic race.**

Plotting bar chart for race variable to see how it is distributed.

```{r, echo = FALSE, message = FALSE}
#Plot Histogram for Race
race.plot <- ggplot(nlsy, aes(x = race, fill = gender)) +
  xlab("Race") 
race.plot + geom_bar(position = "dodge" ) + 
  ggtitle("Histogram for Race")

#Table for seeing the distribution of number of respondents acrss race and gender
race.sex.table <- aggregate(income ~ race + gender, data = nlsy, FUN = length)
#kable(race.sex.table, format = "markdown", digits = 3)
```

By observing the plot we can see that the Male to female ratio in the participants is approximately close to 1:1 across races. 
Around `r with(race.sex.table, sum(race.sex.table[race == "OTHER",]$income))` respondents belong to 'OTHER' race in which around `r with(race.sex.table, race.sex.table[race == "OTHER" & gender == "FEMALE",]$income)` respondents are female. 
Similarly around `r with(race.sex.table, sum(race.sex.table[race == "BLACK",]$income))` respondents are black in which around `r with(race.sex.table, race.sex.table[race == "BLACK" & gender == "FEMALE",]$income)` respondents are female. Out of `r with(race.sex.table, sum(race.sex.table[race == "HISPANIC",]$income))`  Hispaninc respondents, `r with(race.sex.table, race.sex.table[race == "HISPANIC" & gender == "FEMALE",]$income)` are female.


Table summary of race:
```{r, echo = FALSE}
# Table for income distribution and confidence interval by gender and race 
race.table <- ddply(nlsy, ~ race , summarize,
                    group.size = length(income),
                    mean.income = mean(income),
                    sd.income = sd(income),
                    se.income = sd(income) / sqrt(group.size),
                    max.income = max(income),
                    min.income = min(income),
                    income.diff = mean(income[which(gender == 'MALE')]) -
                                  mean(income[which(gender == 'FEMALE')]) ,
                    lower = -t.test(income ~ gender)$conf.int[1],
                    upper = -t.test(income ~ gender)$conf.int[2],
                    is.significant = as.numeric(t.test(income ~ gender)$p.value < 0.05))

# Re-order the race factor according to gap size
race.table <- mutate(race.table,
                           race = reorder(race, income.diff))
race.table
# Plotting income gap across race with error bars  
race.errorbar.plot <- ggplot(race.table, 
                                 aes(x = as.factor(race), y = income.diff, fill = is.significant)) +
  xlab("Race") +
  ylab("Income gap (in $)")
#Display barchart
race.errorbar.plot + geom_bar(stat = "identity", position = "dodge")+
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1)) +
  geom_errorbar( aes(ymin=lower, ymax=upper),
                width = 0.2, size = 1, color = "blue") +
  ggtitle("Difference in income between men and women, by Race")+
  theme(plot.title = element_text(size = 10, face = "bold"))


```


**Hypothesis Testing**

There is clear difference in income between male and female. Male earn higher than female across all races(indicated by positive difference values). The difference is also statistically significant for Hispanic race because the error bar doesn't have the zero in the confidence interval range, which signifies no difference.

The above 2 table shows the income related details of the people from different races. It is observed that the mean income is lowest for people belonging to Black race (`r with(race.table, round(race.table[race == "BLACK",3]))` USD). And the highest income is for people belonging to Other race(`r with(race.table, round(race.table[race == "OTHER",3]))` USD).

It is also observed that although the count of Females in all the races is greater than respective male count, the income for the females in every race is less than the income for the males. 

Thus, race is an important factor that needs to be in consideration for our analysis. 

### 1(b) Family Size
**Hypothesis: Increase in family size will be associated with lower family income**

Scatter plot for family size variable to see its distribution.

```{r, echo = FALSE}
# Plot scatter plot for family size
famsize.plot <- ggplot(nlsy[!is.na(nlsy$famsize), ], aes(x = famsize, y= income, fill = gender)) +
  xlab("Family size") +
  ylab("Income (in $)")
famsize.plot + geom_point() + # Adds points (scatterplot)
  geom_smooth(method = "lm") +# add regression line
  ggtitle("Scatter plot of Income with Family Size, by Gender")
```


The scatter plot suggest that majority of individuals have family size of 1, 2 3 or 4. Also individuals with bigger family size don't seem to have high income ($120,000 and above). 

The regression lines capture the association between income and family size. By seeing the regression line, there appears to be a negative correlation between income of women and family size. The fact that the observed points are very spread out around the regression lines visually convey the fact that the correlation between income and family size is not very large. 



```{r, echo = FALSE}
# Creating a correlation table for family size and income across race
famsize.cor <- kable(ddply(nlsy, ~ gender, summarize,
      cor.inc.famsize = cor(income, famsize)), format = "markdown", digits = 3)

```

I expected to have a negative correlation between family size since I hypothesized that people with larger family sizes may be those people who don't have very high aspirations professionally.  So, increase in family size may be related to decrease in income.
However, there is a positive correlation between income and family size, but the magnitude of correlation is very small ( `r cor(nlsy$income, nlsy$famsize)`). When this association is broken gender wise, there is a weak positive linear relationship between income and family size for men (0.18).  For women, there is a very weak negative linear relationship between income and family size(-0.03) i.e. there is almost no correlation between income and family size for women.  


**Table summary of Family income**


```{r, echo = FALSE}
# Summary of income differences across differ
famsize.table <- ddply(nlsy, ~ famsize , summarize,
      group.size = length(income),
      mean.income = mean(income),
      sd.income = sd(income),
      se.income = sd(income) / sqrt(group.size),
      max.income = max(income),
      min.income = min(income),
      income.diff = mean(income[which(gender == 'MALE')]) -
                              mean(income[which(gender == 'FEMALE')]))

kable(famsize.table, format = "markdown", digits = 3)


```


Majority of the respondents seem to have family size of one, two or three family members. Maximum respondents have family size of two , followed by one followed by three. Less than 100 respondents have family size of 6 or above. 

It is also observed that the family with group size of 4 has the highest mean income.

### 1(c) Region 
**Hypothesis - There is a statistically significant difference between income of men and women from different regions**

**Box plot for checking how income varies across different regions**

```{r, echo = FALSE, , message=FALSE}
# Plot Boxplot for income across regions and gender
options(scipen = 100)
region.plot <- ggplot(na.omit(nlsy), aes(x = region, y = income, fill = gender)) +
  xlab("Region") +
  ylab("Income (in $)")
region.plot + geom_boxplot() +
  scale_y_continuous(labels = scales::comma)+
  ggtitle("Boxplot for income across regions and gender")
  
```


The box plot depicts how median and spread(Inter quartile range) of income is varying across regions. As can be seen, women are earning less than men in all the regions. Also, there are very few women in NorthEast who are high earners (Outliers in this case). Even though majority of women in `SOUTH` earn less than the women in other regions, `SOUTH` has the highest number of high earner female population(People earning more than 1.5 of IQR).To test the statistical significance of the income difference, we can do the t-test and see the difference in below plot.

```{r, echo = FALSE}
#create table for  income gap across regions with confidence intervals 
region.table <- ddply(nlsy[!is.na(nlsy$region), ], ~ region , summarize,
                      group.size = length(income),
                      prop = length(region)/nrow(nlsy),
                      mean.income = mean(income),
                      sd.income = sd(income),
                      se.income = sd(income) / sqrt(group.size),
                      max.income = max(income),
                      min.income = min(income),
                      income.diff = mean(income[which(gender == 'MALE')], na.rm =  TRUE ) -
                                              mean(income[which(gender == 'FEMALE')], na.rm =  TRUE ) ,
                      lower = -t.test(income ~ gender)$conf.int[1],
                      upper = -t.test(income ~ gender)$conf.int[2],
                      is.significant = as.numeric(t.test(income ~ gender)$p.value < 0.05))

# Re-order the region factor according to gap size
region.table <- mutate(region.table,
                           region = reorder(region, income.diff))

# Plotting income gap across region with error bars  
region.errorbar.plot <- ggplot(region.table, 
                                 aes(x = as.factor(region), y = income.diff, fill = is.significant)) +
  xlab("region") +
  ylab("Income gap (in $)")
#Display barchart
region.errorbar.plot + geom_bar(stat = "identity", position = "dodge")+
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1)) +
  geom_errorbar( aes(ymin=lower, ymax=upper),
                width = 0.2, size = 1, color = "blue") +
  ggtitle("Difference in income between men and women, by region")+
  theme(plot.title = element_text(size = 10, face = "bold"))

```

I expected the mean income of women to be lower than mean income of men. And the results of hypothesis testing show that there is statistically significant difference between incomes of men and women in each region. The income gap is highest in ` NORTHCENTRAL` region and lowest in `SOUTH`.  

So region is also an important factor to consider in our model.


### 1(d)  Marital Status
**Hypothesis - There is a statistically significant difference between income of men and women for different marital status**


**i.) Box plot for checking how income varies for different Marital statuses**

```{r, echo = FALSE}
# Box plot for Income distribution for men and women, by Marital Statu
marstat.plot <- ggplot(nlsy, aes(x = marital.status, y = income, fill = gender)) +
  xlab("Marital Status") +
  ylab("Income (in $)")
marstat.plot + geom_boxplot() +
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1)) +
  ggtitle("Income distribution for men and women, by Marital Status") +
  scale_y_continuous( breaks = c(1000, 10000, 25000, 50000, 75000, 100000, 150000))
```

From the observations made from the above gender based income and Marital Status distribution, it is noticed that the Married Male has the highest income (around `80000` USD) as compared to all the people in different categories. It is also observed that the income range for female and male who are `NEVER MARRIED` is similar. The income gap range varies the highest in `MARRIED` category.

**ii.) Histogram for checking the distribution**


```{r, echo = FALSE}
# Histogram for matital status
marstat.hist <- ggplot(nlsy[!is.na(nlsy$marital.status), ], aes(x = marital.status, fill = gender)) +
  xlab("Marital Status") 
marstat.hist + geom_bar(position = "dodge")+
  ggtitle("Histogram for Marital Status")
```

From the Marital Status histogram, it is viewed that the we've highest number of men and women from  married category followed by never married catogory. 

To test the statistical significance of the income difference across marital status, we can do the t.test and see the difference in below plot.

```{r, echo = FALSE}
#create table for  income gap across marital status with confidence intervals 
marital.status.table <- ddply(nlsy[!is.na(nlsy$marital.status), ], ~ marital.status , summarize,
                              group.size = length(income),
                              prop = length(marital.status)/nrow(nlsy),
                              mean.income = mean(income),
                              sd.income = sd(income),
                              se.income = sd(income) / sqrt(group.size),
                              max.income = max(income),
                              min.income = min(income),
                              income.diff = mean(income[which(gender == 'MALE')], na.rm =  TRUE ) -
                                                      mean(income[which(gender == 'FEMALE')], na.rm =  TRUE ) ,
                              lower = -t.test(income ~ gender)$conf.int[1],
                              upper = -t.test(income ~ gender)$conf.int[2],
                              is.significant = as.numeric(t.test(income ~ gender)$p.value < 0.05))

# Re-order the marital.status factor according to gap size
marital.status.table <- mutate(marital.status.table,
                           marital.status = reorder(marital.status, income.diff))

# Plotting income gap across different marital status with error bars  
marital.status.errorbar <- ggplot(marital.status.table, 
                                 aes(x = as.factor(marital.status), y = income.diff, fill = as.factor(is.significant))) +
  xlab("Marital Status") +
  ylab("Income gap (in $)")

#Display barchart
marital.status.errorbar + geom_bar(stat = "identity", position = "dodge")+
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1)) +
  geom_errorbar( aes(ymin=lower, ymax=upper),
                width = 0.2, size = 1, color = "blue") +
  ggtitle("Difference in income between men and women, by Marital Status")+
  theme(plot.title = element_text(size = 10, face = "bold"))
```

Since the error bars for `NEVER MARRIED` and `WIDOWED` category include zero, the difference in income is not statistically significant for these two categories. For `DIVORCED`, `SEPARATED` and `MARRIED` category, the income difference is statistically significant. Thus the hypothesis is true that there is a statistically significant difference between income of men and women for different marital statuses. 
Hence, we'll include Marital Status in our analysis model.


### 1(e). Urban-Rural
**Hypothesis - There is a statistically significant difference between income of men and women for people belonging to urban or rural area**

i.) Histogram for checking the distribution:
```{r, echo = FALSE}
#Plot Histogram of Urban-Rural
urban.hist <- ggplot(nlsy[!is.na(nlsy$urban.rural), ], 
                     aes(x = urban.rural, fill = gender)) +
  xlab("Urban Rural") 
urban.hist + geom_bar(position = "dodge")+
  ggtitle("Histogram of Urban-Rural")
```

By observing the plot we can see that the number of Female is higher in both urban and rural category. 
Total of`r with(nlsy, nrow(nlsy[urban.rural == "URBAN",]))` respondents reside in urban area of which around `r with(nlsy, nrow(nlsy[urban.rural == "URBAN" & gender == "FEMALE",]))` respondents are female. 
Similarly around `r with(nlsy, nrow(nlsy[urban.rural == "RURAL",]))` respondents reside in RURAL area of which around `r with(nlsy, nrow(nlsy[urban.rural == "RURAL" & gender == "FEMALE",]))` respondents are female. 
There's a difference of `r with(nlsy, nrow(nlsy[urban.rural == "URBAN",])) - with(nlsy, nrow(nlsy[urban.rural == "RURAL",]))` between number of urban and rural population.

Table summary for urban.rural :


```{r, echo = FALSE}
#create table for  income gap across urban rural areas with confidence intervals 
urban.table <- ddply(nlsy[!is.na(nlsy$urban.rural), ], ~ urban.rural , summarize,
                    group.size = length(income),
                    prop = length(urban.rural)/nrow(nlsy),
                    mean.income = mean(income),
                    sd.income = sd(income),
                    se.income = sd(income) / sqrt(group.size),
                    max.income = max(income),
                    min.income = min(income),
                    income.diff = mean(income[which(gender == 'MALE')]) -
                                  mean(income[which(gender == 'FEMALE')]) ,
                    lower = -t.test(income ~ gender)$conf.int[1],
                    upper = -t.test(income ~ gender)$conf.int[2],
                    is.significant = as.numeric(t.test(income ~ gender)$p.value < 0.05))

# Re-order the urban-rural factor according to gap size
urban.table <- mutate(urban.table,
                           urban.rural = reorder(urban.rural, income.diff))

# Plot the income difference with error bars
urban.plot <- ggplot(urban.table, 
                                 aes(x = as.factor(urban.rural), y = income.diff)) +
  xlab("Urban Rural") +
  ylab("Difference in Income (in $)")

#Display barchart with error bars
urban.plot + geom_bar(stat = "identity", position = "dodge")+
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1)) +
  geom_errorbar(data = urban.table, 
                mapping = aes(x=urban.rural, ymin=lower, ymax=upper),
                width = 0.2, size = 1, color = "blue") +
  ggtitle("Income gap in male and female for Urban and Rural population  with Errorbars")+
  theme(plot.title = element_text(size = 10, face = "bold"))
```


Our hypothesis test reveals that since the error bars for neither rural nor urban include zero, the difference in income is statistically significant for these two categories. I also expected to see lower income gap for urban area compared to rural because we expect people to be paid more fairly in urban areas. Some reasons for fairer pay scales could be higher education levels, higher awareness in urban areas about income disparity across gender. And this seems to be holding true for our data where difference in income is higher in rural area compared to urban areas. And even though the number of respondents staying in urban areas are much higher than rural areas, the mean income gap between men and women is higher for people residing in rural areas compared to urban areas.   

### 1(f). Spouse income 
**Hypothesis - There is a negative correlation between income of men and spouse income**

```{r, echo = FALSE, message=FALSE}
# Plotting histogram for spouse income  
spouse.inc.plot <- ggplot(nlsy[!is.na(nlsy$spouse.income), ], aes(x = spouse.income)) +
  xlab("Spouse Income (in $) ") 
spouse.inc.plot + geom_histogram() +  scale_x_continuous(labels = scales::comma) + ggtitle("Histogram for Spouse income")
```

A high number of individuals have spouse income as zero (`r with(nlsy, nrow(nlsy[spouse.income == 0,]))`), these can be the cases, when the spouse is not working or they are either single or divorced or never married cases. The histogram's tail has a positive skew to the right (Mean income is higher than median income). The mean income in the distribution is `r round(mean(nlsy$spouse.income, na.rm=TRUE))` USD. There are total of 64 for whom the spouse income is topcoded at 272295.

To assess the association between the spouse income and person's income based on gender we can see following tabular chart and graph.


```{r, echo = FALSE}
# Subset the data to exclude NAs from spouse income column
spouse.table <- subset(nlsy, (!is.nan(nlsy[[8]]) & !is.na(nlsy$spouse.income)))
  
# Correlation table for spouse income
spouse.cor.table <- ddply(spouse.table, ~ gender, summarize,
      group.size = length(spouse.income),
      mean.spouseinc = mean(spouse.income),
      sd.spouse.income = sd(spouse.income),
      se.spouse.income = sd(spouse.income) / sqrt(group.size),
      max.spouse.income = max(spouse.income),
      cor = round(cor(income, spouse.income), digits = 4)) # round correlation value upto 4 decimal places 

#display the correlation table
spouse.cor.table

#Display the income difference bar graph with error bars
ggplot(spouse.table, aes(x=spouse.income, y=income, shape=gender, color=gender)) + 
  geom_point() + # Adds points (scatterplot)
  geom_smooth(method = "lm") + # Adds regression lines
  ylab("Income(in $)") + # Changes y-axis label
  xlab("Spouse income(in $) ") + # Changes x-axis label
  ggtitle("Scatter plot for Spouse income by Gender") + # Changes plot title
  scale_x_continuous(labels = scales::comma)
```



I expected to see a negative correlation between income and spouse income for men and vice-versa for female.  This hypothesis was based on the understanding that since income disparity exists between men and women, so for heterosexual men their female spouse might be earning less than their male counterparts.  However, the data suggests that there is a positive correlation between incomes of men and their spouse's income. The scatterplot also depicts the higher density of blue dots on the upper side of the income and higher density of pink dots on the lower side of the income.
One interesting phenomenon to notice here is that there are a lot of women who earn USD 50,000 or less but have spouses who are in the topcoded earners category. However there is only such male who earn less than $50,000 but have a high earner spouse. 

**Hypothesis Testing **

Overall there is a weak positive correlation between income and spouse income( - `r cor(spouse.table$income, spouse.table$spouse.income)`). When this association is broken down gender wise, there is a slightly positive linear relationship between income and spouse income for men ( `r spouse.cor.table[spouse.cor.table$gender == 'MALE', 7]`).  For women, there is a very weak positive linear relationship between income and spouse income( `r spouse.cor.table[spouse.cor.table$gender == 'FEMALE', 7]`) i.e. almost to the effect of no correlation between income and spouse income for women.

the distance between them


## Part 2 : Methodology

### 2 (a) Factor selection
Selection of the factors was done initially on the basis of inspection of the data. Then I tried to identify top ten factors which could be interesting to analyze and work with. Apart from income and gender, I selected race, region, family size, highest grade completed, occupation industry, region, marital status, spouse income, number of drinks respondent has on average day, religion and country of birth.

On analyzing `Highest Grade Completed`, I saw that there were many levels and for some levels there was very less data. 
`Type of Business or Industry` was also dropped because there were 22 levels and a lot of them couldn't be collapsed or binned together. So this would have impacted the analysis because for some levels there were very few rows of data.

`Number of drinks per day` had 3322 Valid skips. Since I wasn't sure what could be the valid skips cases in this scenario I cannot directly impute the data with some number or even with zero. Because if people don't drink at all, for such people the survey should have entry for zero drinks per day.  So to avoid any incorrect interpretations of the data, I decided to skip this factor from my analysis.

`Country of birth` - More than 90 percent of the respondents were born in US (11811 out of 12685). And only 874 were born out of US. So this study would have resulted in majority of the analysis for US born people and I believed that I won't be able to uncover any interesting relationship from this factor. So I decided to skip it.

`Spouse income` - I wanted to keep atleast two continuous variables in my analysis and spouse income seemed very interesting to me. I believed that I would be able to analyse some interesting trends about income disparity by observing the spouse income. For instance if a married woman is earning high, does her spouse earn higher than her or lower. 

After lot of contemplation and analysis of data, I decided to keep Race, Region, Family Size, Region, Marital Status, and Spouse Income as my factors for this study.

### 2 (b) Treatment of Missing values 
**Non-interview (-5): **

The rows containing -5 were replaced with NA since this is the case in which interview could not be conducted for that year. The reasons for non-interview could be since the respondent could have relocated or refused to interview. There were 5385 non-interview cases for income, family size, region, spouse income and urban-rural variables. 

**Valid Skips (-4): **
For income - 7 valid skips can be when person was earning earlier but not earning now. Region of residence had 60 valid skip since the person could now have moved to a place other than the 4 regions. This was imputed as NA.
There is an important consideration for spouse income since there are 3479 valid skips. These can be the cases when the spouse in not earning, or a person is single, or widowed or divorced so no data for spouse's income exist. For such cases, spouse income was imputed as 0.

**Invalid Skip (-3): **
Count of invalid skips - Income - 5, Marital status - 2, spouse_income - 2
The interviewer might have skipped these question while interviewing due to incorrect flow in the questionnaire. Thus data cannot be imputed or assumed for such situations. Hence such rows are replaced with NA.

**Refusal (-1): **
Count of refusal - Income - 119, spouse_income - 125
Count of Don't Know(-2) - Income - 146, spouse_income - 159
Some of the cases when Refusal can be encountered when the respondents are not sure about the confidentiality of the survey. If the respondents are not fully satisfied by the justification from interviewers they wont respond. Since, people with high income or even with low income equally have the chances of refusal owing to their own personal reasons, so we can't impute such data with zero or average values. Thus, these values are replaced with NA.
 
**Don't know(-2): **
Count of Don't Know(-2) - Income - 146, spouse_income - 159
Don't know cases can be encountered when the respondents either don't remember or they are genuinely unaware about the fact. Since, people with high income or even with low income equally have the chances of `don't know` owing to their own personal reasons, so we can't impute such data with zero or average values. Thus, these values are replaced with NA.

**Impact on generalizability : **
The count of respondents for valid skips, refusal, don't know, and invalid skips is not very high. The count of valid skip for spouse's income was high. But since these are the cases in which the spouse's income won't have been available so imputing 0 wont impact much of our analysis. 
Thus, as per my understanding, our analysis of gender based income variation won't vary much for the variables that are being analyzed (such as across race, family size, region).


### 2 (c) Treatment of Topcoded  variables
Inclusion of the topcoded income data was impacting the initial analysis as well as Regression estimates. The estimates and confidence intervals were both getting biased due to the topcoded data especially for low end of the income. Such topcoded data can change the relationship between income and other variables and thus our whole analysis could be rendered meaningless for low and average income household characteristics.

Thus, after careful inspection, topcoded data was not included in the analysis. This is done to improve the generalizability of the resulting analysis because otherwise due to high leverage of topcoded data, our analysis couldn't show the clear picture for the relationship between different variables. 
This means that now this analysis will not be applicable for top earners. However, we can now more correctly analyze the results for low and average income individuals. 

### 2 (d) Relationships that were investigated but not included in findings
Highest grade completed was investigated in the initial stage. Since HGC has 24 levels, it is difficult to analyze them as it is. Also for a lot of levels, the count of observations are either very small, zero or less than 50 which impact the analysis. One way is to collapse them into smaller numbers of bins. 

`Type of business or industry` was also investigated as part of the analysis. However, this variable has 22 levels, with some levels having very less count of respondents. So the data set had already shrunk because of large non-interview cases making it difficult to get substantial results. Additionally, there were 792 valid skips which cannot be imputed for any default industry. Thus, owing to all the above reasons, `Type of business or industry` was not included further in the investigation.

### 2 (e) Tables or plots that were expected to reveal interesting trends but didn't

**(i) Removal of outlier in family size and income plot**

While performing the hypothesis testing for correlation between family size and income, there was one data point for family size 16 for a female respondent (with income in the lower end of the spectrum, around USD 25,000). The below chart shows the scatterplot for family size and income reproduced after removing the outlier. 

```{r, echo = FALSE}
# Get new data set that no longer contains the outlier
family.sub <- subset(nlsy[!is.na(nlsy$famsize), ], subset = famsize < 13)

# pLot Scatter plot of family size and income, across genders
ggplot(family.sub, aes(x = famsize, y= income, fill = gender)) +
  xlab("Family size") + ylab("Income (in $)")+
  geom_point() + # Adds points (scatterplot)+
  ggtitle("Scatter plot of family size and income, across genders")+
  geom_smooth(method = "lm")
```

```{r, echo = FALSE }
# Correlation between family size and income, gender-wise
kable(ddply(family.sub, ~ gender, summarize,
      cor.inc.famsize = cor(income, famsize)), format = "markdown", digits = 3)

```
Even after excluding the point and doing the analysis again to see if the correlation between income and family size changes for women, no significant change in the value of correlation was found.  

**(ii) Negative correlation between income and family size **

I expected to see negative correlation between income and family size because people with higher family size could be those who are not very highly motivated professionally. But this didn't seemed to be true from the data which showed positive correlation between family size and income. One possible reason for this could that people who have bigger families tend to understand the higher responsibility to support their bigger families. So they tend to work harder to get higher incomes. 

**(iii) Collinearity between family size, marital status and Urban-rural **

I expected to see some collinearity between family size, marital status and Urban-rural areas of residence. But there seems to be no collinearity between these three factors. I expected married people to have bigger family size and people living in urban areas to have smaller family sizes and people belonging to urban areas to have bigger families. But no discernible trend could be uncovered from the data regarding the same.

**(iv) Negative correlation between spouse income and income for men**

 I expected to see negative correlation between spouse income and income for men and a positive  correlation between spouse income and income for female respondents. This is because I expected that generally for heterosexual male respondents their spouse will be female. So their spouse's income should be lower since as per my hypothesis women on average earn lower than men.  But the trend was found to be reverse. One reason for very low correlation between income and spouse income for female respondents could that in such households, women started working because of the reason that their spouses were not earning high.


### 2 (f) Finalized variables 
After assessing the different variables Gender, Family size, region, marital status, urban-rural and spouse income were finalized to be included in the analysis.


## Part 3 : Findings - Using Regression

#### QQplot - Diagnostic for finding the normality of data

**QQ plot for income distribution for Female**

```{r, echo = FALSE}
## qq plot for Female income data
with(nlsy, qqnorm(income[gender=="FEMALE" ]  )) 
# add reference line
with(nlsy, qqline(income[gender=="FEMALE"], col = "blue")) 
```

**QQ plot for income distribution for Male**

```{r, echo = FALSE}
## qq plot for male income data

with(nlsy, qqnorm(income[gender=="MALE" ]  ))
# add reference line
with(nlsy, qqline(income[gender=="MALE"], col = "red"))

```

The QQplot depicts whether income distribution is normal or not normal. For both the QQplots for income by male and by female, the  residuals appear highly non-normal. Since there are a lot of people who responded zero income, we've a flat line at the bottom. Since the income distribution was not expected to be this high density at the lower end, it is causing non-normality of data. The upper upper tail is heavier than we would expect under normality. This is because we have more extreme values than would be expected if the income truly came from a Normal distribution. 

### Regression 
Regression of income with all the variables - `gender`,`race`,`famsize`,`region`,`marital.status`, `urban.rural`, `spouse.income`. This is the main effects model in which we investigate the relationship between income and all the other factors. This model will give the effect of change of each factor on income, keeping all other factors constant.

#### Model 1 : Main Effects Model


**Regression Output**

```{r, echo = FALSE}
# Regressing income against all variables
income.lm <- lm(income ~ ., data = nlsy)
options(scipen=5) 
# Regression output 
kable(summary(income.lm)$coef, digits = c(3, 3, 3, 4))
```


Looking at the p-values, it looks like `raceHISPANIC` (respondents belonging to race HISPANIC), `raceOTHER` (respondents belonging to race OTHER), `genderMALE` (respondents belonging to gender MALE), regionNORTHEAST (respondents belonging to region NORTHEAST), `marital.statusMARRIED` (respondents having marital status as married), `marital.statusNEVER MARRIED` (respondents having marital status NEVER MARRIED), `marital.statusSEPARATED`  (respondents having marital status as SEPARATED), `urban.ruralURBAN` (Respondents belonging to Urban locality) and `spouse.income` (income of the respondent's spouse) are the variables that are all statistically significant predictors of income.

The coefficients for these predictors (except `marital.statusNEVER MARRIED` and `marital.statusSEPARATED`) are all positive, so income is positively associated with respondent's race, respondent's region being NORTHEAST, respondent's  marital status being married, respondent's locality - Urban or rural and spouse's income in the population.

The interpretation for spouse.income variable is that all else being equal between two individuals, each unit increase in spouse's income appears to be associated with 0.064 increase in individuals income.

Interpretation of Categorical variable :
The estimate of `raceHISPANIC` means that the estimated income is 3031.7 higher among `HISPANIC` race respondents compared to BLACK respondents (Since BLACK is the first level in race so it is taken as baseline). Similarly, the estimated income is 11251.5 higher for OTHER race respondents than `BLACK` respondents.

Similarly, all being equal, income of Married individual is 7312 higher than a divorced  individuals (Since Divorced is the baseline category). On the other hand, all else being equal, an individual whi never married earn 4922 less than a divorced individual.



```{r, echo = FALSE}
plot(income.lm)
```

**Residuals vs. Fitted** 

The plot is looking like a funnel. That is, the residual get more and more spread out as the fitted values increase. Our standard linear regression assumption that the variance is constant across the entire range is violated here so we cannot derive meaningful insights from this linear model. The model is inappropriate and we cannot rely on the confidence intervals and p-values calculated by the model. 

**Normal QQ plot **

In the above plot we see that the residuals deviate from the diagonal line in both the upper and lower tail. In this case we see that the right tail are observed to be have higher values than what we would expect under the standard modeling assumptions. Also at the left end of tail we have more extreme values (high number of individuals reporting income to be zero) than would be expected if they truly came from a Normal distribution. 
The residuals appear highly non-normal. This may be due to the non-constant variance issue we observed in the Residuals vs. Fitted plot.

**Scale-location plot **

There's a clear increasing trend in the red trend line in this plot, which indicates possible non-constant (increasing) variance.  

**Residuals vs Leverage **

There's a point which seem to have high leverage and can be considered an outlier. Its skewing the model fit away from the rest of the data, and don't really seem to fit with the rest of the data.


#### Collinearity and pairs plots
Lets see some collinearity plots to see if there exits any collinearity between the chosen factors. Because if the factors are collinear then it could impact our analysis negatively because our regression coefficients of collinear data are not the correct estimates of the model. Thus we need to remove any factor which is highly collinear with another factor.

```{r, echo = FALSE, warning=FALSE, message=FALSE}
# ggpairs to find the collinearity between family size, marital status and urban-rural
ggpairs(nlsy[,c("famsize", "marital.status", "urban.rural"  )], axisLabels = "internal",  upper = list(continuous = wrap("cor", size = 3 )))
```


By seeing the collinearity plot, we are unable to discern any significant collinearity between different factors. Since we cannot discern the value of one factor by seeing another factor thus our we don't need to exclude any variable from our analysis and we'll keep all the original variables in our model.

I expected to find some collinearity  between family size and marital status and between family size and urban.rural but there doesn't appear to be a notable collinearity.

### Interaction Models
The above model only showed the relationship between income and other factors. To see how gender impacts the relationship between those factors and income, we need to analyse the interaction models. The interaction coefficients correspond to differences in earnings across gender and that factor levels that aren't accounted for by a model that assumes independent effects for the factor and gender. 

#### Model 2: Interaction between Race and Gender
As we've seen above in our hypothesis testing for Race, we identified that there is a significant gap in income between men and women across different races. So we'll have to assess the interaction between race and gender.

Below model shows the result of including the race and gender interaction term in our Main effects model (Original regression model).

**Regression Output**


```{r, echo = FALSE}
# Regressing income against all variables with interaction term
#race.interact.lm <- lm(income ~ . + race * gender, data = nlsy)
race.interact.lm <- update(income.lm, . ~ . + race*gender)

options(scipen=5) 
# Summary of the linear regression model
kable(summary(race.interact.lm)$coef, digits = c(3, 3, 3, 4))

```


**Interpretation of results:**

On adding the interaction term between race and gender, two more additional terms got added. `raceHISPANIC:genderMALE` and `raceOTHER:genderMALE`. These are the terms which compare from the differences at this level from the baseline level(race Black and gender Female).

For instance, the income difference among Hispanic men and Hispanic women is $6915 more than the difference between Black men and Black women(Coefficient of  `raceHISPANIC:genderMALE` term). Race is a factor that is highly associated with the income gap between men and women.
The income difference between men and women appears to depend strongly on the individual's race since the two interaction terms that appear additionally in the interaction model are statistically significant. Also, now we can see that the term `raceHISPANIC` is no more statistically significant since the effect of being in Hispanic race is now being captured by  `raceHISPANIC:genderMALE` term.

**Testing significance of the interaction term with anova**

To test whether the observed differences in income gap across the race categories are statistically significant, we perform anova test. 

```{r, echo = FALSE}
options(scipen=100) # to display numeric values and not scientific values
anova(income.lm, race.interact.lm)
```

The p-value is statistically significant being close to 0.000001 so we can reject the null hypothesis that the income gap is the same across all the race categories. In other words, the data suggests that the income gap between men and women does vary with race.

#### Model 3: Interaction between Gender and region
As we've seen above in our hypothesis testing for Region, we identified that there is a significant gap in income between men and women across different regions. So we'll have to assess the interaction between region and gender.

Below model shows the result of including the region and gender interaction term in our Main effects model (Original regression model).

**Regression Output **

```{r, echo = FALSE}
# Regressing income against all variables with interaction term
region.interact.lm <- update(income.lm, . ~ . + region*gender)
options(scipen=5) 
# Summary of the linear regression model
kable(summary(region.interact.lm)$coef, digits = c(3, 3, 3, 4))

```


**Interpretation of results:**

The income difference between men and women appears to depend strongly on the individual's region. For instance, the income difference between men and women among people from WEST region is $1000 more than the difference between men and women from NOrthCentral region (given by genderMALE:regionWEST). Thus Region is a factor that is highly associated with the income gap between men and women.
However, the three interaction terms that appear additionally in the interaction model are not statistically significant. 

```{r, echo = FALSE}
options(scipen=100) # to display numeric values and not scientific values
anova(income.lm, region.interact.lm)
```

However, after adding the interaction terms, it turns out that the difference in income between men and women across  region is not statistically significant (p-value = .207).

#### Model 4: Interaction between Gender and marital status
As we've seen above in our hypothesis testing for marital status, we identified that there is a significant gap in income between men and women across different marital statuses. So we'll have to assess the interaction between marital status and gender.

Below model shows the result of including the marital status and gender interaction term in our Main effects model (Original regression model).

**Regression Output**

```{r, echo = FALSE}
# Regressing income against all variables with interaction term
marstat.interact.lm <- update(income.lm, . ~ . + marital.status*gender)
options(scipen=5) 
# Nicer print-out
kable(summary(marstat.interact.lm)$coef, digits = c(3, 3, 3, 4))

```


**Interpretation of results:**

The income difference between men and women appears to depend strongly on the individual's marital status.  For instance, the income difference between `MARRIED` men and women is $19665 more than the income difference between `DIVORCED`men and women (given by genderMALE:marital.statusMARRIED). Thus marital  is a factor that is highly associated with the income gap between men and women.
Out of the four interaction terms that appear additionally in the interaction model, two are statistically significant - `genderMALE:marital.statusMARRIED` and `genderMALE:marital.statusNEVER MARRIED`. 


```{r, echo = FALSE}
# Testing significance of the interacton term with anova
options(scipen=100) # to display numeric values and not scientific values
anova(income.lm, marstat.interact.lm)
```

The p-value from anova is statistically significant being close to 0.000001 so we can reject the null hypothesis that the income gap is the same across all the marital status categories. In other words, the data suggests that the income gap between men and women does vary with marital status.

**Diagnostic Plots **

```{r, echo = FALSE}
plot(marstat.interact.lm)
```

The diagnostics plots for this interaction model are almost similar to the one that we got from the main effects model. 

**Residuals vs. Fitted** 
The plot is looking like a funnel. That is, the residual get more and more spread out as the fitted values increase. The model is inappropriate and we cannot rely on the confidence intervals and p-values calculated by the model. 

**Normal QQ plot **
In the above plot we see that the residuals deviate from the diagonal line in both the upper and lower tail. In this case we see that the right tail are observed to be have higher values than what we would expect under the standard modeling assumptions. Also at the left end of tail we have more extreme values (high number of individuals reporting income to be zero) than would be expected if they truly came from a Normal distribution. 
The residuals appear highly non-normal. This may be due to the non-constant variance issue we observed in the Residuals vs. Fitted plot.

**Scale-location plot **
There's a clear increasing trend in the red trend line in this plot, which indicates possible non-constant (increasing) variance.  

**Residuals vs Leverage **
There's a point which seem to have high leverage and can be considered an outlier. Its skewing the model fit away from the rest of the data, and don't really seem to fit with the rest of the data.

Cook's distance:
There are many points that lie close to the dashed red line and hence they are worth investigating further.

#### Model 5: Interaction between Gender and spouse income
As we've seen above in our hypothesis testing for spouse income, we identified that there is a statistically significant gap in income between men and women across different spouse incomes. So we'll have to assess the interaction between spouse income and gender.

Below model shows the result of including the spouse income and gender interaction term in our Main effects model (Original regression model).

```{r, echo = FALSE}
# Regressing income against all variables with interaction term
spouse.interact.lm <- update(income.lm, . ~ . + spouse.income * gender)
options(scipen=5) 
# Nicer print-out
kable(summary(spouse.interact.lm)$coef, digits = c(3, 3, 3, 4))

```


**Interpretation of results:**

Now we can see that the term `spouse.income` is no more statistically significant since the effect of spouse income is now being captured by  `genderMALE:spouse.income` term.

The income difference between men and women appears to depend positively on the spouse's income however the magnitude of relation is very low (0.324). The interaction term that appears additionally in the interaction model is statistically significant. 

```{r, echo = FALSE}
options(scipen=100) # to display numeric values and not scientific values
anova(income.lm, spouse.interact.lm)
```

The p-value is statistically significant being close to 0.000 so we can reject the null hypothesis that the income gap is the same across all the race categories. In other words, the data suggests that the income gap between men and women does vary with spouse income.

#### Model 6: Interaction between Gender and urban-rural
As we've seen above in our hypothesis testing for urban-rural, we identified that there is a statistically significant gap in income between men and women across different urban-rural. So we'll have to assess the interaction between urban-rural and gender.

Below model shows the result of including the urban-rural and gender interaction term in our Main effects model (Original regression model).

```{r, echo = FALSE}
# Regressing income against all variables and interaction term
urban.interact.lm <- update(income.lm, . ~ . + urban.rural * gender)
# Summary of the linear regression model
options(scipen=5) 
kable(summary(urban.interact.lm)$coef, digits = c(3, 3, 3, 4))

```


**Interpretation of results:**

The income difference between men and women doesn't appear to depend strongly on the individual's area being Urban or rural. This is because the p-value of the two interaction terms `genderMALE:urban.ruralUNKNOWN` and `genderMALE:urban.ruralURBAN` is way greater than 0.05.  
However, the term urban.ruralURBAN is statistically significant(p-value = 0.000).

```{r, echo = FALSE}
options(scipen=5) 
anova(income.lm, urban.interact.lm)
```

The p-value is not statistically significant (0.8693), so we cannot reject the null hypothesis that the income gap is the same across all urban or rural areas. In other words, the data suggests that the income gap between men and women donot depend strongly on the individual's area being urban or rural.


## Discussion :

In summary, we had the main effects model and the interaction models which showed some interesting results from the data. 
Family size is not a significant factor to identify how the income gap varies across family sizes. 
Factors like `race`, `marital status`, and `spouse income` seem to be statistically significant in identifying the income difference between men and women across these categories. Interestingly, `region` and `urban.rural` seemed to have statistically significant difference in income across gender during our initial data analysis and hypothesis testing phase. However, when the interaction terms between `region` and `gender` or between `urban.rural` and `gender` were included, the interaction was not statistically significant. This implies that income gap doesn't differ across `region` category or `urban.rural` category.

#### Potential Limitation 
The potential limitations of this analysis are - 

**a.  **	Inability to identify causation -

The coefficients of like `race`, `marital status`, and `spouse.income` seem to be statistically significant in identifying the income difference between men and women across these categories. But this doesn't imply causation that these factors are causing the income gap.

**b.  **	Even though `spouse.income` is statistically significant, its coefficient is very low(0.324). Hence this doesn't seem to be a good predictor of income. 

**c.	  ** The qqplots and residual plot show there are extreme values with high residual and high leverage which are impacting our results. We cannot be 100 percent sure about the models since all of them had high residuals. The residuals were spreading more and more out as the fitted value was increasing.

**d.	** The Cook's distance identified points that were drastically changing the results of the model. So such data points need to be re-examined further.

**e. **	The R2 being the ratio of regression sum of squares to total sum of squares, tells you how much percent of variability in income is explained by the model. All the six models had R2 in the range of  0.12-0.14. Thus, only about 12-14 percent of variability in income gap is explained by the chosen six variables. Thus, we need to investigate further to identify other important factors which could be the reasons behind the income gap between men and women.

#### Potential Confounders
Since all the six models had R2 in the range of  0.12-0.14. Thus, only about 12-14 percent of variability in income gap is explained by the chosen six variables. Thus there will be other variables that need to be controlled for in this analysis. For example education levels, type of occupation or industry etc could be important factors that could be included to see their effect on income gap.

#### Model fit
The model seems fit in the sense that there were three main factors that were identified to be statistically significant in this analysis. They are `race`, `marital status`, and `spouse income`. The interaction between these factors and gender also confirm the impact of these variables on income gap across these factors. Also, the coefficients of `race`, `marital status` are substantial to explain some variability in income gap. 

**Confidence in Analysis  **

Its difficult to put a number to the level of confidence in this analysis, but still I've approximately 30-40 percent confidence in this analysis. Due to high residuals and many outliers which have high leverage, the model is not a very good estimate to explain the variability in income completely. However, this analysis reinforced the belief that race and marital status definitely have significant impact on income gap. This could be taken as a first step to move further in our investigation. 
Now we also know what variables don't seem to have a significant impact on income gap - family size, region, urban or rural area of residence. So we can drop them in our future analysis.

I would like to do further analysis of the data, include or exclude the outliers and identify the causes of high residual before presenting these findings to policy makers. But at the same time, I could definitely suggest the policy makers to look at the impact of Race and marital status on the income gap.


